<%- include ('../partials/header') %>
<main>
  <div class="verificationPassword-wrapper">
    <% if (message === "USERS_INVALID_VALUE") { %>
    <p style="color: red"><%= 'パスワードが正しく入力されていません。'%></p>
    <% } else if(message) { %>
    <p style="color: red"><%= '予期せぬエラーが起きました。'%></p>
    <% }else{%>
    <p style="color: red"><%= ''%></p>
    <% } %>

    <p>パスワードリセット</p>
    <div class="row">
      <form class="col s12" action="/users/verificationPassword" method="post">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <input
          type="hidden"
          name="verificationToken"
          value="<%=verificationToken%>"
        />
        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">vpn_key</i>
            <input
              id="password"
              type="password"
              class="validate"
              name="password"
              required="required"
              minlength="8"
              pattern="^[a-zA-Z\d]{8,100}"
            />
            <label for="password">パスワード（半角英数字8文字以上）</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">vpn_key</i>
            <input
              id="password_confirm"
              type="password"
              class="validate"
              name="password_confirm"
              required="required"
              minlength="8"
            />
            <label for="password_confirm">パスワード（確認用）</label>
          </div>
        </div>
        <button
          class="btn waves-effect waves-light"
          type="submit"
          name="action"
        >
          登録
        </button>
      </form>
    </div>
  </div>
</main>
<%- include ('../partials/footer') %>
